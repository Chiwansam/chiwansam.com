<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chiwansam</title>
  <meta name="description" content="静かなギャラリーポータル" />
  <style>
    :root{
      --bg:#ffffff;          /* 背景 */
      --ink:#111;            /* 文字 */
      --muted:#666;          /* 補助文字 */
      --line:#e9e9e9;        /* 罫線 */
      --accent:#9b87f5;      /* さりげないアクセント */
      --card-radius:20px;
      --gap:28px;            /* カード間余白 */
      --maxw:1280px;         /* コンテンツ最大幅 */
    }
    html,body{height:100%}
    body{
      margin:0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", "Meiryo", sans-serif;
      background:var(--bg); color:var(--ink);
      line-height:1.6;
    }
    /* ヘッダー */
    header{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.75));
      backdrop-filter: blur(6px);
      border-bottom:1px solid var(--line);
    }
    .bar{
      max-width:var(--maxw); margin:0 auto; display:flex; align-items:center; justify-content:space-between;
      padding:16px 20px;
    }
    .brand{font-size:20px; letter-spacing:.06em; font-weight:700}
    .menu a{color:var(--ink); text-decoration:none; opacity:.8; margin-left:16px}
    .menu a:hover{opacity:1}

    /* リード（静かなコピー） */
    .lead{max-width:var(--maxw); margin:36px auto 6px; padding:0 20px;}
    .lead p{margin:0; color:var(--muted)}

    /* カードグリッド */
    .grid{
      max-width:var(--maxw); margin:0 auto; padding:20px; display:grid; gap:var(--gap);
      grid-template-columns: repeat(12, 1fr);
    }
    /* カード：2サイズ（大/中）。行き先の種類で自由に混在可能 */
    .card{grid-column: span 12; position:relative; overflow:hidden; border-radius:var(--card-radius); border:1px solid var(--line); background:#f8f8f8}
    .card-media{aspect-ratio: 16/9; background:#ddd; display:block; width:100%; object-fit:cover;}
    .card-body{position:absolute; inset:auto 0 0 0; padding:20px; background:linear-gradient(180deg, transparent 0%, rgba(0,0,0,.55) 65%);
      color:#fff;}
    .card-eyebrow{font-size:12px; letter-spacing:.08em; opacity:.9}
    .card-title{font-size:clamp(20px, 2.2vw, 28px); font-weight:700; margin:.2em 0 .2em}
    .card-desc{font-size:14px; opacity:.9}
    .card:hover .card-body{background:linear-gradient(180deg, rgba(0,0,0,.15) 0%, rgba(0,0,0,.65) 65%)}
    .card:focus-within{outline:2px solid var(--accent)}
    .card a.coverlink{position:absolute; inset:0; text-indent:-9999px}

    /* レイアウトサイズ：大カード=横6、中=横4、スマホは縦並び */
    .card.size-lg{grid-column: span 12}
    .card.size-md{grid-column: span 6}

    @media (min-width: 768px){
      .card.size-lg{grid-column: span 12}
      .card.size-md{grid-column: span 6}
    }
    @media (min-width: 1024px){
      .card.size-lg{grid-column: span 12}
      .card.size-md{grid-column: span 6}
    }

    footer{max-width:var(--maxw); margin:40px auto; padding:0 20px 60px; color:var(--muted); font-size:13px;}

    /* フェードイン */
    .reveal{opacity:0; transform:translateY(12px); transition: all .6s ease}
    .reveal.show{opacity:1; transform:none}
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">Chiwansam</div>
      <nav class="menu" aria-label="トップメニュー">
        <a href="#" aria-label="すべての作品">All</a>
        <a href="#" aria-label="連絡先">Contact</a>
      </nav>
    </div>
  </header>

  <div class="lead" aria-live="polite">
    <p>静かな入り口。画像・タイトル・短い言葉だけで、各部屋へ案内します。</p>
  </div>

  <!-- カードは JSON (portal.json) から動的生成します -->
  <main class="grid" id="grid" aria-label="リンク一覧"></main>

  <footer>
    © <span id="year"></span> Chiwansam. Minimal portal.
  </footer>

  <script>
  // ====== 設定 ======
  // JSONの設置場所（S3/CloudFrontや静的ホスティングのルートに合わせてパスを変更）
  const DATA_URL = '/assets/portal.json';

  // JSON 仕様：
  // [
  //   {
  //     "category": "ウォーハンマー",        // 小さな見出し（任意）
  //     "title": "ティラニッドプライム",   // 大きなタイトル
  //     "description": "紫の影。静かな戦場の記憶。", // 2-3行まで
  //     "image": "/images/tyranid_prime.jpg", // 大きく見せる画像
  //     "link": "/warhammer/tyranid-prime.html", // 遷移先
  //     "size": "md"                              // "lg" または "md"（省略時 md）
  //   },
  //   { "category":"ガンプラ", "title":"Artifact", "description":"…", "image":"…", "link":"…", "size":"md" },
  //   { "category":"音楽", "title":"Lost Fragment", "description":"…", "image":"…", "link":"/music/index.html", "size":"lg" },
  //   { "category":"日記", "title":"Quiet Notes", "description":"…", "image":"…", "link":"/diary/", "size":"md" }
  // ]

  // フォールバック（JSONが未配置のときに仮表示）
  const FALLBACK = [
    {category:'音楽', title:'Lost Fragment', description:'静かな電子の花が咲く。', image:'https://picsum.photos/seed/chiwa-music/1200/675', link:'#', size:'lg'},
    {category:'ウォーハンマー', title:'Tyranid Prime', description:'紫の装甲。淡い艶。', image:'https://picsum.photos/seed/chiwa-warhammer/1200/675', link:'#', size:'md'},
    {category:'ガンプラ', title:'Artifact Archive', description:'手触りのある赤。整面の呼吸。', image:'https://picsum.photos/seed/chiwa-gunpla/1200/675', link:'gunpla.html', size:'md'},
    {category:'日記', title:'Quiet Notes', description:'思考を置く場所。', image:'https://picsum.photos/seed/chiwa-notes/1200/675', link:'#', size:'md'}
  ];

  const grid = document.getElementById('grid');

  function makeCard(item){
    const size = (item.size === 'lg') ? 'size-lg' : 'size-md';
    const card = document.createElement('article');
    card.className = `card ${size} reveal`;
    card.innerHTML = `
      <img class="card-media" alt="${escapeHtml(item.title)}" src="${item.image}">
      <div class="card-body">
        ${ item.category ? `<div class="card-eyebrow">${escapeHtml(item.category)}</div>` : '' }
        <div class="card-title">${escapeHtml(item.title)}</div>
        <div class="card-desc">${escapeHtml(item.description || '')}</div>
      </div>
      <a class="coverlink" href="${item.link}" aria-label="${escapeHtml(item.title)} へ移動">${escapeHtml(item.title)}</a>
    `;
    return card;
  }

  function render(list){
    grid.innerHTML = '';
    list.forEach(item=> grid.appendChild(makeCard(item)));
    reveal();
  }

  // 安全なエスケープ
  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s]));
  }

  // JSONを取得して描画
  fetch(DATA_URL, {cache:'no-cache'})
    .then(r => r.ok ? r.json() : FALLBACK)
    .then(data => Array.isArray(data) ? render(data) : render(FALLBACK))
    .catch(()=> render(FALLBACK));

  // 年号
  document.getElementById('year').textContent = new Date().getFullYear();

  // スクロールで静かにフェードイン
  function reveal(){
    const obs = new IntersectionObserver((entries)=>{
      for(const e of entries){ if(e.isIntersecting){ e.target.classList.add('show'); obs.unobserve(e.target); } }
    }, {threshold: .12});
    document.querySelectorAll('.reveal').forEach(el=> obs.observe(el));
  }
  </script>
</body>
</html>



